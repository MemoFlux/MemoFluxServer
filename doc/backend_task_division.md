# 后端开发任务分工方案

## 项目概述
基于场景1-8的后端实现，2人协作开发，围绕 **Information Manager** 和 **Schedule Manager** 两大核心模块展开。

## 模块划分与人员分工

### 开发者A：Information Manager 负责人
**核心职责：** 负责所有信息的采集、解析、存储、分类和知识图谱构建

#### 负责场景
- **场景1：深度研究与论文写作** (核心场景)
- **场景2：跨平台策划"城市周末漫游"** 
- **场景3：装修与家居采购**
- **场景8：碎片化学习与技能提升**

#### 具体任务清单

##### 1. 信息采集与解析模块
- [ ] **OCR文本提取服务**
  - 实现图片文字识别接口
  - 支持PDF、图片、截图等多格式
  - 集成tesseract或云服务OCR

- [ ] **链接内容抓取服务**
  - 网页内容解析（标题、正文、关键信息）
  - 微信公众号文章解析
  - 小红书、抖音等平台内容适配

- [ ] **多源数据标准化**
  - 统一不同来源的数据格式
  - 建立标准数据结构（标题、内容、来源、时间戳等）

##### 2. AI标签与分类系统
- [ ] **智能标签引擎**
  - 基于BAML的AI提示词工程
  - 场景1：学术标签（核心论点、数据支撑、反方观点、待引用）
  - 场景2/3：活动标签（地点、时间、预算、类型）
  - 场景8：学习标签（知识点、难度、前置要求）

- [ ] **实体识别与关联**
  - 人名、书名、机构名识别
  - 建立实体间关系图谱
  - 支持自定义实体词典

##### 3. 知识图谱构建
- [ ] **图数据库设计**
  - Neo4j图数据库建模
  - 节点类型：信息片段、标签、实体、来源
  - 关系类型：引用、支持、反对、相关

- [ ] **知识树自动生成**
  - 场景8：基于标签层级构建知识树
  - 场景1：基于章节结构组织论文素材
  - 支持手动调整层级关系

##### 4. 存储与索引
- [ ] **混合存储架构**
  - PostgreSQL：结构化数据存储
  - Neo4j：关系图谱存储
  - MinIO/S3：文件对象存储

- [ ] **全文搜索引擎**
  - Elasticsearch集成
  - 支持模糊搜索、语义搜索
  - 建立多维度索引（标签、时间、来源）

### 开发者B：Schedule Manager 负责人
**核心职责：** 负责任务识别、时间管理、提醒系统和日历集成

#### 负责场景
- **场景4：会议纪要与任务跟进** (核心场景)
- **场景5：个人健康与情绪管理**
- **场景6：求职与面试准备**
- **场景7：处理临时与非正式的约定**

#### 具体任务清单

##### 1. 任务识别与解析引擎
- [ ] **多轮对话任务提取**
  - 从连续对话中识别最终任务状态
  - 支持微信群、邮件、Slack等多平台格式
  - 实现任务状态追踪（创建→更新→完成）

- [ ] **三要素提取算法**
  - Who（责任人）识别
  - What（任务内容）提取
  - When（截止时间）解析
  - 支持模糊时间解析（"下周"、"明天下午"）

- [ ] **任务冲突检测**
  - 时间冲突自动检测
  - 优先级智能判断
  - 资源冲突提醒

##### 2. 时间管理与提醒系统
- [ ] **智能时间解析**
  - 自然语言时间解析（"本周五下班前"）
  - 相对时间计算（"下下周"）
  - 节假日和工作日识别

- [ ] **分层提醒机制**
  - 即时提醒：任务创建时
  - 预设提醒：截止前24小时、1小时
  - 智能提醒：基于用户习惯调整

- [ ] **重复任务处理**
  - 周期性任务识别
  - 重复提醒设置
  - 任务完成状态同步

##### 3. 日历与第三方集成
- [ ] **iOS日历集成**
  - EventKit框架集成
  - 双向同步机制
  - 权限管理和错误处理

- [ ] **提醒事项集成**
  - iOS Reminders API
  - 任务状态同步
  - 列表管理

- [ ] **第三方服务适配**
  - 邮件服务（Gmail、企业邮箱）
  - 会议系统（腾讯会议、Zoom）
  - 即时通讯（微信、Slack）

##### 4. 健康与情绪联动
- [ ] **健康数据集成**
  - Apple HealthKit接入
  - 情绪日记API对接
  - 数据隐私保护

- [ ] **智能推荐引擎**
  - 基于情绪状态推荐内容
  - 健康习惯养成提醒
  - 个性化建议生成

## 协作接口定义

### 模块间通信协议
```python
# Information Manager -> Schedule Manager
class TaskCreationRequest:
    source_id: str          # 信息来源ID
    task_content: str       # 任务内容
    assignee: str          # 责任人
    deadline: datetime     # 截止时间
    priority: str          # 优先级
    metadata: dict         # 附加信息

# Schedule Manager -> Information Manager  
class TaskStatusUpdate:
    task_id: str           # 任务ID
    status: str            # 状态：pending/completed/cancelled
    completion_time: datetime  # 完成时间
    notes: str             # 备注信息
```

### 共享数据结构
- **用户信息表**：用户ID、偏好设置、第三方账号绑定
- **内容元数据**：来源类型、创建时间、原始链接、截图路径
- **任务关联表**：信息片段与任务的关联关系

## 开发优先级

### 第一阶段（MVP）
1. 基础信息采集（A）
2. 简单任务识别（B）
3. 基础存储和索引（A）
4. 简单提醒功能（B）

### 第二阶段（核心功能）
1. AI标签系统（A）
2. 三要素提取（B）
3. 日历集成（B）
4. 知识图谱基础（A）

### 第三阶段（高级功能）
1. 多轮对话理解（B）
2. 知识树生成（A）
3. 健康数据集成（B）
4. 智能推荐（A+B）

## 测试策略

### 单元测试
- 每个模块独立测试
- 模拟数据验证
- 边界条件测试

### 集成测试
- 模块间接口测试
- 端到端场景测试
- 性能压力测试

### 场景测试
- 基于8个场景的完整流程测试
- 真实用户数据验证
- 用户体验评估

## 部署与监控

### 部署架构
- Docker容器化部署
- 微服务拆分（信息管理服务、时间管理服务）
- 负载均衡和自动扩缩容

### 监控指标
- API响应时间
- 任务识别准确率
- 用户活跃度
- 系统资源使用率

## 风险与应对

### 技术风险
- **OCR准确率**：多引擎备份，人工校验机制
- **AI理解偏差**：用户反馈闭环，持续优化模型
- **第三方API限制**：本地缓存，降级方案

### 协作风险
- **接口变更**：版本控制，向后兼容
- **数据一致性**：分布式事务，最终一致性
- **进度同步**：每日站会，代码审查

## 交付物清单

### 开发者A交付物
- [ ] 信息采集API文档
- [ ] 标签系统技术方案
- [ ] 知识图谱设计文档
- [ ] 存储架构说明

### 开发者B交付物
- [ ] 任务识别算法文档
- [ ] 时间管理接口规范
- [ ] 第三方集成指南
- [ ] 提醒系统设计方案

## 时间规划
- **第1-2周**：基础架构搭建，数据库设计
- **第3-4周**：核心功能开发（信息采集+任务识别）
- **第5-6周**：AI能力集成，标签系统
- **第7-8周**：第三方集成，日历同步
- **第9-10周**：高级功能，性能优化
- **第11-12周**：测试完善，文档整理
